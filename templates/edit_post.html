{% extends '_layout.html' %}

{% block title %}Upload to Stock Whisperers{% endblock %}
{% block body %}

<main>
    <h1>Edit Post</h1>
    <form action="/posts/update/{{ post.post_id }}" method="post" enctype="multipart/form-data">
        <div class="w-75 mt-4">
            <input type="text" name="title" id="title" class="form-control" placeholder="Title" value="{{ post.title }}" required>
            <br>
            <input id="text" type="hidden" name="text" required value="{{ post.content }}">
            <trix-editor style="background-color: white;" input="text" placeholder="Text (optional)"></trix-editor>
        </div>

        <div class="w-75 mt-3 d-flex justify-content-between">
            <input class="form-control w-50" type="file" id="image_upload" name="image_upload" accept="image/*">
            <input type="submit" class="btn btn-primary w-25" value="Update">
        </div>
    </form>
</main>
<script type="text/javascript">

    function validateForm() {
        // Validate image file if selected
        var imageUpload = document.getElementById('image_upload');
        if (imageUpload.files.length > 0) {
            var allowedExtensions = /(\.jpg|\.jpeg|\.png|\.gif)$/i;
            if (!allowedExtensions.exec(imageUpload.value)) {
                alert('Invalid file type. Please upload a valid image file (jpg, jpeg, png, gif).');
                return false;
            }
        }
        return true;
    }

    (function () {
        addEventListener("trix-initialize", function (e) {
            const file_tools = document.querySelector(".trix-button-group--file-tools");
            file_tools.remove();
        })
        addEventListener("trix-file-accept", function (e) {
            e.preventDefault();
        })
    })();
</script>
{% endblock %}